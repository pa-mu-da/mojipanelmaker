<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文字パネルメーカー</title>
    <link rel="stylesheet" href="style.css">
    <!-- JSZip for ZIP generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- Google Fonts Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Noto+Serif+JP:wght@400;700&family=Zen+Kaku+Gothic+New:wght@400;700&family=Zen+Maru+Gothic:wght@400;700&family=M+PLUS+1p:wght@400;700&family=Sawarabi+Mincho&family=Kiwi+Maru:wght@400;500&family=Kaisei+Decol:wght@400;700&family=Kaisei+HarunoUmi:wght@400;700&family=Shippori+Mincho+B1:wght@400;700&family=Yuji+Mai&family=Zen+Antique+Soft&family=WDXL+Lubrifont+JP+N&family=Dela+Gothic+One&family=Potta+One&family=RocknRoll+One&display=swap"
        rel="stylesheet">
</head>

<body>
<!-- ナビゲーションバー - ここから貼り付け開始 -->
<style>
  /* カラーテーマCSS変数 */
  :root { /* Light Theme (Default) */
    --app-bg-color: #f9fafb;
    --app-text-color: #111827;
    --header-bg-color: rgba(255, 255, 255, 0.8);
    --modal-bg-color: #ffffff;
    --button-hover-bg-color: #d1d5db;
    --link-active-text-color: #3730a3;
    --border-color: #d1d5db;
  }
  html.dark {
    --app-bg-color: #111827;
    --app-text-color: #f3f4f6;
    --header-bg-color: rgba(31, 41, 55, 0.8);
    --modal-bg-color: #1f2937;
    --button-hover-bg-color: #6b7280;
    --link-active-text-color: #e0e7ff;
    --border-color: #4b5563;
  }
  html.theme-earth.dark {
    --app-bg-color: #3e2723;
    --app-text-color: #efebe9;
    --header-bg-color: rgba(62, 39, 35, 0.8);
    --modal-bg-color: #4e342e;
    --button-hover-bg-color: #795548;
    --link-active-text-color: #ffffff;
    --border-color: #795548;
  }
  html.theme-pastel {
    --app-bg-color: #fff0f5;
    --app-text-color: #5c3c4c;
    --header-bg-color: rgba(255, 240, 245, 0.8);
    --modal-bg-color: #ffffff;
    --button-hover-bg-color: #90e0d0;
    --link-active-text-color: #333;
    --border-color: #e1bee7;
  }
  html.theme-gray {
    --app-bg-color: #f5f5f5;
    --app-text-color: #333333;
    --header-bg-color: rgba(238, 238, 238, 0.8);
    --modal-bg-color: #ffffff;
    --button-hover-bg-color: #bbbbbb;
    --link-active-text-color: #ffffff;
    --border-color: #b0b0b0;
  }
  
  /* ナビゲーションバースタイル */
  #top-nav-bar {
    background-color: var(--header-bg-color);
    color: var(--app-text-color);
    border-bottom: 1px solid var(--border-color);
    transition: colors 0.3s;
  }
  
  /* ドロップダウンスタイル */
  .nav-dropdown {
    position: relative;
  }
  .nav-dropdown-menu {
    display: none;
    position: absolute;
    top: 100%;
    right: 0;
    background-color: var(--modal-bg-color);
    border: 1px solid var(--border-color);
    border-radius: 0.375rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    min-width: 200px;
    z-index: 1000;
    margin-top: 0.25rem;
    padding: 0.5rem 0;
  }
  .nav-dropdown.active .nav-dropdown-menu {
    display: block;
  }
  .nav-dropdown-menu a {
    display: block;
    padding: 0.5rem 1rem;
    color: var(--app-text-color);
    text-decoration: none;
    transition: background-color 0.2s;
  }
  .nav-dropdown-menu a:hover {
    background-color: var(--button-hover-bg-color);
  }
  .nav-dropdown-toggle {
    cursor: pointer;
    user-select: none;
  }
</style>

<div id="top-nav-bar">
  <div style="max-width: 1280px; margin: 0 auto; padding: 0.5rem 1rem; display: flex; align-items: center; justify-content: flex-end; gap: 1.5rem; font-size: 0.875rem;">
        <div class="nav-dropdown">
          <span class="nav-dropdown-toggle hover:text-[--link-active-text-color] transition-colors">NPC向け立ち絵配布</span>
          <div class="nav-dropdown-menu">
            <a href="https://tatie.pages.dev/">現代日本</a>
            <a href="https://tatie2.pages.dev/">近未来・サイバーパンク</a>
            <a href="https://tatie3.pages.dev/">和風・時代劇</a>
          </div>
        </div>
        <div class="nav-dropdown">
          <span class="nav-dropdown-toggle hover:text-[--link-active-text-color] transition-colors">TRPGに使えるツール類</span>
          <div class="nav-dropdown-menu">
            <a href="https://pa-mu-da.github.io/shape/">図形を手軽に作るやつ</a>
            <a href="https://pa-mu-da.github.io/pndtool/caragen.html">カード画像作成ツール</a>
            <a href="https://pa-mu-da.github.io/mojipanelmaker/">文字パネルメーカー</a>
            <a href="https://pa-mu-da.github.io/memotool/">PC・URLメモツール</a>
            <a href="https://pa-mu-da.github.io/solo_RPG_tool/">ソロRPGコンパニオン</a>
          </div>
        </div>
        <a href="https://ttrpglinks.pages.dev/" class="hover:text-[--link-active-text-color] transition-colors">TRPGお役立ちリンク</a>
  </div>
</div>

<script>
  // ドロップダウンナビゲーション
  (function() {
    const dropdownToggles = document.querySelectorAll('.nav-dropdown-toggle');
    dropdownToggles.forEach(toggle => {
      toggle.addEventListener('click', (e) => {
        e.stopPropagation();
        const dropdown = toggle.parentElement;
        const wasActive = dropdown.classList.contains('active');
        
        // すべてのドロップダウンを閉じる
        document.querySelectorAll('.nav-dropdown').forEach(d => d.classList.remove('active'));
        
        // 現在のドロップダウンをトグル
        if (!wasActive) {
          dropdown.classList.add('active');
        }
      });
    });
    
    // 外側クリックでドロップダウンを閉じる
    document.addEventListener('click', () => {
      document.querySelectorAll('.nav-dropdown').forEach(d => d.classList.remove('active'));
    });
  })();
</script>
<!-- ナビゲーションバー - ここまで貼り付け終了 -->
    
    <div class="app-container">
        <header>
            <h1>文字パネルメーカー</h1>
            <p>テキストから画像をかんたん生成</p>
            <p>このツールから生成される画像は全てユーザーの権利と責任の下に自由にご利用ください</p>
            <p>クレジットその他もろもろは不要です</p>
        </header>

        <main>
            <div class="settings-panel">
                <section class="setting-group">
                    <h2>1. サイズ設定</h2>
                    <div class="input-row">
                        <label>
                            幅 (px)
                            <input type="number" id="canvasWidth" value="800" step="100" min="100">
                        </label>
                        <label>
                            高さ (px)
                            <input type="number" id="canvasHeight" value="600" step="100" min="100">
                        </label>
                    </div>
                    <div class="input-row">
                        <label>
                            比率 (幅:高)
                            <div class="ratio-inputs">
                                <input type="number" id="ratioWidth" placeholder="4" min="1">
                                <span>:</span>
                                <input type="number" id="ratioHeight" placeholder="3" min="1">
                            </div>
                        </label>
                        <button id="applyRatioBtn" class="secondary-btn">比率適用</button>
                    </div>
                </section>

                <section class="setting-group">
                    <h2>2. 背景設定</h2>
                    <div class="radio-group">
                        <label><input type="radio" name="bgType" value="transparent" checked> 透過</label>
                        <label><input type="radio" name="bgType" value="color"> 単色</label>
                        <label><input type="radio" name="bgType" value="image"> 画像</label>
                    </div>

                    <div id="bgSettingColor" class="sub-setting hidden">
                        <div class="input-row">
                            <label>背景色 <input type="color" id="bgColor" value="#ffffff"></label>
                        </div>
                    </div>

                    <div id="bgSettingImage" class="sub-setting hidden">
                        <input type="file" id="bgImageInput" accept="image/*">
                    </div>

                    <div id="bgSettingColorImage" class="sub-setting hidden">
                        <div class="input-row">
                            <label><input type="checkbox" id="bgBorderEnabled"> 枠線をつける</label>
                        </div>
                        <div class="input-row indent">
                            <label>枠線色 <input type="color" id="bgBorderColor" value="#000000"></label>
                            <label>太さ <input type="number" id="bgBorderWidth" value="10" min="0"> px</label>
                        </div>
                        <div class="input-row indent" id="borderImageSection" style="display: none;">
                            <label><input type="checkbox" id="borderImageEnabled"> 枠線に画像を重ねる</label>
                        </div>
                        <div class="input-row indent" id="borderImageSettings"
                            style="display: none; margin-left: 48px;">
                            <label>画像 <input type="file" id="borderImageInput" accept="image/*"></label>
                        </div>
                        <div class="input-row indent" id="borderImageBlend" style="display: none; margin-left: 48px;">
                            <label>合成モード
                                <select id="borderImageBlendMode">
                                    <option value="normal">通常</option>
                                    <option value="overlay">オーバーレイ</option>
                                    <option value="multiply">乗算</option>
                                    <option value="screen">スクリーン</option>
                                </select>
                            </label>
                        </div>
                        <div class="input-row indent" id="borderImageOpacity" style="display: none; margin-left: 48px;">
                            <label>透明度 <input type="range" id="borderImageOpacitySlider" min="0" max="100" value="100">
                                <span id="borderImageOpacityValue">100</span>%</label>
                        </div>
                        <div class="input-row">
                            <label>角丸 <input type="number" id="bgCornerRadius" value="0" min="0"> px</label>
                        </div>
                        <div class="input-row">
                            <label>余白 <input type="number" id="bgPadding" value="0" min="0"> px</label>
                        </div>
                    </div>
                </section>

                <section class="setting-group">
                    <h2>3. 文字設定</h2>
                    <div class="input-row">
                        <label>
                            フォント
                            <select id="fontSelect">
                                <option value="Noto Sans JP">Noto Sans JP (ゴシック)</option>
                                <option value="Noto Serif JP">Noto Serif JP (明朝)</option>
                                <option value="Zen Kaku Gothic New">Zen角ゴシック</option>
                                <option value="Zen Maru Gothic">Zen丸ゴシック</option>
                                <option value="M PLUS 1p">M PLUS 1p</option>
                                <option value="Sawarabi Mincho">さわらび明朝</option>
                                <option value="Kiwi Maru">Kiwi Maru</option>
                                <option value="Kaisei Decol">Kaisei Decol</option>
                                <option value="Kaisei HarunoUmi">Kaisei HarunoUmi</option>
                                <option value="Shippori Mincho B1">Shippori Mincho B1</option>
                                <option value="Yuji Mai">Yuji Mai</option>
                                <option value="Zen Antique Soft">Zen Antique Soft</option>
                                <option value="WDXL Lubrifont JP N">WDXL Lubrifont JP N</option>
                                <option value="Dela Gothic One">Dela Gothic One (極太)</option>
                                <option value="Potta One">Potta One (ポップ)</option>
                                <option value="RocknRoll One">RocknRoll One (ロック)</option>
                            </select>
                        </label>
                    </div>
                    <div class="input-row">
                        <label>
                            ウェイト (太さ)
                            <select id="fontWeight">
                                <option value="400">Regular (標準)</option>
                                <option value="700" selected>Bold (太字)</option>
                            </select>
                        </label>
                    </div>
                    <div class="input-row">
                        <label>
                            フォントサイズ
                            <input type="number" id="fontSize" value="45" min="10"> px
                        </label>
                    </div>
                    <div class="input-row">
                        <label>ファイル読込 <input type="file" id="fontFileInput" accept=".ttf,.otf,.woff,.woff2"></label>
                    </div>
                    <div class="input-row">
                        <label>文字色 <input type="color" id="textColor" value="#000000"></label>
                        <label>行揃え
                            <select id="textAlign">
                                <option value="left">左揃え</option>
                                <option value="center" selected>中央揃え</option>
                                <option value="right">右揃え</option>
                            </select>
                        </label>
                    </div>
                    <div class="input-row">
                        <label><input type="checkbox" id="textOutlineEnabled" checked> 文字の縁取り</label>
                    </div>
                    <div class="input-row indent">
                        <label>縁取り色 <input type="color" id="textOutlineColor" value="#ffffff"></label>
                        <label>太さ <input type="number" id="textOutlineWidth" value="5" min="0"> px</label>
                    </div>
                    <div class="input-row indent" id="doubleOutlineSection" style="display: none;">
                        <label><input type="checkbox" id="doubleOutlineEnabled"> 二重縁取り</label>
                    </div>
                    <div class="input-row indent" id="doubleOutlineSettings" style="display: none; margin-left: 48px;">
                        <label>
                            <input type="radio" name="doubleOutlineMode" value="normal" checked> 通常
                        </label>
                        <label>
                            <input type="radio" name="doubleOutlineMode" value="blur"> ぼかし
                        </label>
                    </div>
                    <div class="input-row indent" id="doubleOutlineColorWidth"
                        style="display: none; margin-left: 48px;">
                        <label>色 <input type="color" id="doubleOutlineColor" value="#000000"></label>
                        <label>太さ <input type="number" id="doubleOutlineWidth" value="3" min="1"> px</label>
                    </div>
                </section>
            </div>

            <div class="main-content">
                <section class="input-area">
                    <h2>テキスト入力</h2>
                    <p class="hint">空行で区切ると複数の画像を生成します。</p>
                    <textarea id="textInput"
                        placeholder="ここにテキストを入力&#13;&#10;改行も反映されます&#13;&#10;&#13;&#10;空行を挟むと&#13;&#10;次の画像になります"></textarea>
                    <button id="generateBtn" class="primary-btn">画像を生成する (反映)</button>
                </section>

                <section class="preview-area">
                    <div class="preview-header">
                        <h2>プレビュー</h2>
                        <button id="downloadZipBtn" class="action-btn">すべてZIPで保存</button>
                    </div>
                    <div id="previewContainer" class="preview-grid">
                        <!-- Generated images will appear here -->
                        <div class="placeholder-msg">「画像を生成する」ボタンを押してください</div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    <script src="script.js"></script>
</body>


</html>
